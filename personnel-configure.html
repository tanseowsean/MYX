<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="icon" href="images/favicon.png" type="image/png" sizes="16x16">
    <title>MYX Baggage Tracking System</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;500&display=swap" rel="stylesheet">
</head>

<body>

    <div class="container">

        <!-- Header -->
        <header>
            <div class="logo"><img src="images/logoXS.png" alt=""></div>
            <div class="account">
                <div class="text">
                    Hello, Xuan
                    <a href="#" class="logout">Log Out</a>
                </div>
                <img src="images/user.png" alt="">
            </div>
        </header>
        <!-- /Header -->

        <!-- Menu -->
        <div class="menu">
            <a href="personnel-mainmenu.html" class="item">
                <div class="icon"><img src="images/icon-menu.png" alt=""></div>
                <div class="text">Main Menu</div>
            </a>
            <a href="personnel-checkin.html" class="item">
                <div class="icon"><img src="images/icon-checkin.png" alt=""></div>
                <div class="text">Check In</div>
            </a>
            <a href="personnel-flightsmain.html" class="item">
                <div class="icon"><img src="images/icon-plane.png" alt=""></div>
                <div class="text">Flights</div>
            </a>
            <a href="personnel-configure.html" class="item">
                <div class="icon"><img src="images/icon-gear.png" alt=""></div>
                <div class="text">Configure</div>
            </a>
            <a href="personnel-baggage.html" class="item">
                <div class="icon"><img src="images/icon-luggage.png" alt=""></div>
                <div class="text">Baggage</div>
            </a>
            <a href="personnel-analytics.html" class="item">
                <div class="icon"><img src="images/icon-data-analytics.png" alt=""></div>
                <div class="text">Analytics</div>
            </a>
        </div>
        <!-- /Menu -->

        <!-- Hamburger -->
        <div class="hamburger">
            <img src="images/hamburger.png" alt=""> MENU
        </div>
        <!--/Hamburger -->

        <!-- Mobile Menu -->
        <div class="mobile-menu">
            <a href="personnel-mainmenu.html" class="item">
                <div class="icon"><img src="images/icon-menu.png" alt=""></div>
                <div class="text">Main Menu</div>
            </a>
            <a href="personnel-checkin.html" class="item">
                <div class="icon"><img src="images/icon-checkin.png" alt=""></div>
                <div class="text">Check In</div>
            </a>
            <a href="personnel-flightsmain.html" class="item">
                <div class="icon"><img src="images/icon-plane.png" alt=""></div>
                <div class="text">Flights</div>
            </a>
            <a href="personnel-configure.html" class="item">
                <div class="icon"><img src="images/icon-gear.png" alt=""></div>
                <div class="text">Configure</div>
            </a>
            <a href="personnel-baggage.html" class="item">
                <div class="icon"><img src="images/icon-luggage.png" alt=""></div>
                <div class="text">Baggage</div>
            </a>
            <a href="personnel-analytics.html" class="item">
                <div class="icon"><img src="images/icon-data-analytics.png" alt=""></div>
                <div class="text">Analytics</div>
            </a>
            <div class="close"><img src="images/close.png" alt=""></div>
        </div>
        <!-- /Mobile Menu -->

        <!-- Content-Area -->
        <div class="content">

            <!-- display list of airports -->
            <div class="main-title">
                Configurable Airports

                <div class="subtitle">
                    Select airport to configure
                </div>
            </div>

            <div id="tableContent" class="table-wrapper">
                <table id="tableAirport" class="pSelectTable" cellspacing="0" cellpadding="0" width="100%">
                    <thead>
                        <th>No.</th>
                        <th>Airport ID</th>
                        <th>Airport Name</th>
                        <th>Airport State</th>
                        <th></th>
                    </thead>
                    <tbody id="tbodyAirports"></tbody>
                </table>
            </div>
            <!-- /display list of airports -->
        </div>
        <!-- /Content-Area -->

        <!-- Footer -->
        <footer>
            <div class="logo">
                <img src="images/logo-wt.png" alt="">
            </div>
            <div class="copyright">
                Copyright Â© MYX Baggage Tracking System 2023 All Rights Reserved.
            </div>
        </footer>
        <!-- /Footer -->

    </div>

    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.2.1/firebase-firestore.js"></script>

    <script id="firebaseScript">
        const firebaseConfig = {
            apiKey: "AIzaSyAsIlkYQFu9rExzhdpG5HHfnhEI66Unj-4",
            authDomain: "myx-baggage.firebaseapp.com",
            projectId: "myx-baggage",
            storageBucket: "myx-baggage.appspot.com",
            messagingSenderId: "342593572959",
            appId: "1:342593572959:web:4eac93d796cfa787000bea",
            measurementId: "G-5SKV7NKZY1"
        };

        firebase.initializeApp(firebaseConfig);
        let db = firebase.firestore();

        //function to update data in real time whenever there are changes in database record
        function getAllDataRealtime() {
            db.collection("airports").onSnapshot((querySnapshot) => {
                var airports = [];
                var allID = [];
                querySnapshot.forEach(doc => {
                    airports.push(doc.data());
                    allID.push(doc.id);
                });

                var tContent = "";

                if (allID.length < 1)
                {
                    tContent = '<p>No airport records found.</p>';
                    $(tContent).appendTo('#tableContent');
                    $('#tableAirport').hide();
                }
                else
                {
                    $('p').hide();
                    $('#tableAirport').show();
                    addAllItemToTable(allID, airports);
                }
            });
        }

        //function to display data on website page table
        var airportNo = 0;
        var tbody = document.getElementById('tbodyAirports');

        function addItemToTable(airportID, airportName, airportState) {
            var trow = document.createElement('tr');
            var td1 = document.createElement('td');
            var td2 = document.createElement('td');
            var td3 = document.createElement('td');
            var td4 = document.createElement('td');
            var td5 = document.createElement('td');

            td1.innerHTML = ++airportNo;
            td2.innerHTML = airportID;
            td3.innerHTML = airportName;
            td4.innerHTML = airportState;

            var form = document.createElement('form');
            form.setAttribute('method', 'get');
            form.setAttribute('action', 'personnel-configureairport.html');
            var inputField = document.createElement('input');
            inputField.type = "hidden";
            inputField.name = "airportID";
            inputField.value = airportID;
            var btn = document.createElement('input');
            btn.type = "submit";
            btn.value = "Configure";
            btn.className = "pSelectTableBtn";
            form.appendChild(inputField);
            form.appendChild(btn);
            td5.appendChild(form);

            trow.appendChild(td1);
            trow.appendChild(td2);
            trow.appendChild(td3);
            trow.appendChild(td4);
            trow.appendChild(td5);

            tbody.appendChild(trow);
        }

        function addAllItemToTable(AirportsIDList, AirportsDocList) {
            airportNo = 0;
            tbody.innerHTML = "";
            AirportsDocList.forEach(element => {
                addItemToTable(AirportsIDList[airportNo], element.airportName, element.airportState);
            });
        }

        // function addRowHandlers() {
        //     var table = document.getElementById('tableAirports');
        //     var rows = table.getElementsByTagName('tr');

        //     for (i = 0; i < rows.length; i++) {
        //         var currentRow = table.rows[i];
        //         var createClickHandler =
        //             function (row) {
        //                 return function () {
        //                     var cell = row.getElementsByTagName("td")[1];
        //                     var id = cell.innerHTML;
        //                     alert("id:" + id);
        //                 };
        //             };

        //         currentRow.onclick = createClickHandler(currentRow);
        //     }
        // }

        window.onload = getAllDataRealtime();
    </script>

    <!-- <script>
        var table = document.getElementById('tableAirports');
        var rows = table.getElementsByTagName('tr');

        for (var i = 0; i < rows.length; i++) {
            var currentRow = table.rows[i];
            var createClickHandler = function (row) {
                return function () {
                    var cell = row.getElementsByTagName("td")[1];
                    var id = cell.innerHTML;
                    alert("id: " + id);
                };
            };
            currentRow.onclick = createClickHandler(currentRow);

            // table.rows[i].onClick = function () {
            //     rIndex = this.rowIndex;
            //     console.log(this.cells[rIndex].innerHTML);
            //     // //get the airport id
            //     // db.collection("airports").get().then((querySnapshot) => {
            //     //     var allID = [];
            //     //     querySnapshot.forEach(doc => {
            //     //         allID.push(doc.id);
            //     //     });
            //     // });

            //     // //go to the specific airport's configuration page
            //     // var url = "personnel-configureairport.html?airport=" + allID[i];
            //     // window.location(url);
            // }
        }
    </script> -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="js/main.js"></script>
</body>

</html>